'use strict';

angular.module('notebookApp')
  .controller('ShowController', [
      'notebook',
      'NotebookSvc',
      function(notebook, NotebookSvc) {
        var showCtrl = this;
        showCtrl.notebook = NotebookSvc.build(notebook);

        var openDividerSet = function(openingDivider){
          if(openingDivider.children && openingDivider.children.length > 0){
            openingDivider = openDividerSet(openingDivider.children[0]);
          }
          return openingDivider;
        }

        showCtrl.currentDivider = openDividerSet(showCtrl.notebook);

        showCtrl.setCurrentDivider = function(divider){
          showCtrl.currentDivider = divider;
          divider.notes = divider.notes.sort(function(a,b){return parseInt(a.order) > parseInt(b.order)})
        }
      }
  ]);
