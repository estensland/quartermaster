'use strict';

angular.module('notebookApp').directive('noteArea', [
  'NoteSvc',
  function(NoteSvc){
    return{
      restrict: 'E',
      templateUrl: "<%= asset_path('notebooks/templates/directives/noteArea.html') %>",
      scope:{
        notes: '=',
        dividerId: '='
      },
      link: function(scope, element, attrs){
        element.click(function(e){
          var box = this.getBoundingClientRect()
          var hstore = {x: e.clientX - box.left, y: e.clientY - box.top}
          var newNote = NoteSvc.build({body: '', hstore: hstore, divider_id: scope.dividerId})
          newNote.$create()
          scope.notes.push(newNote)

          scope.$apply()
        })
      }
    }
  }
]);
